module.exports=function(e,t){"use strict";var r={};function __webpack_require__(t){if(r[t]){return r[t].exports}var n=r[t]={i:t,l:false,exports:{}};e[t].call(n.exports,n,n.exports,__webpack_require__);n.l=true;return n.exports}__webpack_require__.ab=__dirname+"/";function startup(){return __webpack_require__(131)}return startup()}({87:function(e){e.exports=require("os")},129:function(e){e.exports=require("child_process")},131:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const i=o(r(470));const s=o(r(322));const u=o(r(315));const c=()=>n(void 0,void 0,void 0,function*(){try{const e=i.getInput("files",{required:true});const t=e.split("\n").map(e=>e.trim()).filter(e=>!!e);if(t.length===0){throw new Error("nothing to deploy")}const r=i.getInput("owner",{required:true});const n=i.getInput("repo",{required:true});const o=process.env.GITHUB_DEPLOYMENT_TOKEN;if(!o){throw new Error("GITHUB_DEPLOYMENT_TOKEN environment variable is not set properly")}console.log("files:",JSON.stringify(t,null,2));console.log("repo:",`${r}/${n}`);const c="__temp__";yield s.cmd("mkdir ",[`-p ${c}`]);yield u.publishToRepo(t,c,{accessToken:o,owner:r,repo:n})}catch(e){console.error(e);i.setFailed(e.message)}});c()},315:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const i=o(r(622));const s=o(r(322));function publishToRepo(e,t,r){return n(this,void 0,void 0,function*(){const n=process.cwd();const o=`https://${r.accessToken}@github.com/${r.owner}/${r.repo}.git`;const u=i.join(t,`deployment`);const c=yield s.git(["--no-pager show -s --format='%cN' HEAD"]);const a=yield s.git(["--no-pager show -s --format='%cE' HEAD"]);yield s.cmd("rm -rf",[`${u}`]);yield s.cmd("mkdir ",[`-p ${u}`]);process.chdir(u);yield s.git(["init"]);yield s.git([`remote add origin ${o}`]);yield s.git(["fetch origin master --depth=1"]);yield s.git(["checkout origin/master"]);yield s.git(["checkout -b master"]);process.chdir("../..");yield s.cmd("rm -rf",[`${u}/*`]);yield s.git([`log --format="%h %s" -n 1 > ${u}/commit_message`]);for(const t of e){yield s.cmd("cp -r",[t,u])}process.chdir(u);yield s.git([`config user.name "${c}"`]);yield s.git([`config user.email "${a}"`]);yield s.git(["add --all"]);try{yield s.git(["commit -F commit_message"])}catch(e){if(e.output&&e.output.indexOf("nothing to commit")){throw new Error("Nothing has changed, abort")}else{throw e}}yield s.git(["push origin master --force"]);process.chdir(n)})}t.publishToRepo=publishToRepo},322:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const o=n(r(129));function exec(e,t,r=fromPath){return new Promise((n,i)=>{o.exec(r(e)+" "+t.join(" "),(e,t)=>{if(e){const r=t.toString().trim();return i({err:e,output:r})}n(t.toString())})})}t.exec=exec;function cmd(e,t){return exec(e,t,e=>e)}t.cmd=cmd;function git(e){return cmd("git",e)}t.git=git;function npm(e){return cmd("npm",e)}t.npm=npm;function ignoreErrors(e){return e.catch(()=>null)}t.ignoreErrors=ignoreErrors;function fromPath(e){return e}t.fromPath=fromPath},431:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(87);function issueCommand(e,t,r){const o=new Command(e,t,r);process.stdout.write(o.toString()+n.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const o="::";class Command{constructor(e,t,r){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=r}toString(){let e=o+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";for(const t in this.properties){if(this.properties.hasOwnProperty(t)){const r=this.properties[t];if(r){e+=`${t}=${escape(`${r||""}`)},`}}}}e+=o;const t=`${this.message||""}`;e+=escapeData(t);return e}}function escapeData(e){return e.replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escape(e){return e.replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/]/g,"%5D").replace(/;/g,"%3B")}},470:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:true});const o=r(431);const i=r(87);const s=r(622);var u;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(u=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){process.env[e]=t;o.issueCommand("set-env",{name:e},t)}t.exportVariable=exportVariable;function setSecret(e){o.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){o.issueCommand("add-path",{},e);process.env["PATH"]=`${e}${s.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r){throw new Error(`Input required and not supplied: ${e}`)}return r.trim()}t.getInput=getInput;function setOutput(e,t){o.issueCommand("set-output",{name:e},t)}t.setOutput=setOutput;function setFailed(e){process.exitCode=u.Failure;error(e)}t.setFailed=setFailed;function debug(e){o.issueCommand("debug",{},e)}t.debug=debug;function error(e){o.issue("error",e)}t.error=error;function warning(e){o.issue("warning",e)}t.warning=warning;function info(e){process.stdout.write(e+i.EOL)}t.info=info;function startGroup(e){o.issue("group",e)}t.startGroup=startGroup;function endGroup(){o.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return n(this,void 0,void 0,function*(){startGroup(e);let r;try{r=yield t()}finally{endGroup()}return r})}t.group=group},622:function(e){e.exports=require("path")}});